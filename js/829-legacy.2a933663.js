"use strict";(self["webpackChunkpc_exam_student"]=self["webpackChunkpc_exam_student"]||[]).push([[829],{4829:function(t,e,n){n.r(e),n.d(e,{default:function(){return p}});n(44114);var r=function(){var t,e,n,r,s=this,i=s._self._c;return i("div",{directives:[{name:"loading",rawName:"v-loading",value:s.loading,expression:"loading"}],staticClass:"practice-exam"},[i("div",{staticClass:"exam-header"},[i("div",{staticClass:"left"},[i("div",{staticClass:"back",on:{click:function(t){return s.$router.back()}}},[i("i",{staticClass:"el-icon-arrow-left"}),s._v(" 返回 ")]),i("div",{staticClass:"title"},[s._v(s._s(s.getExamTitle))])]),i("div",{staticClass:"right"},[i("div",{staticClass:"stats"},[i("span",{staticClass:"stat-item"},[s._v("答对："+s._s(s.correctCount)+"题")]),i("span",{staticClass:"stat-item"},[s._v("答错："+s._s(s.wrongCount)+"题")]),i("span",{staticClass:"stat-item"},[s._v("正确率："+s._s(s.correctRate)+"%")])]),i("el-checkbox",{model:{value:s.autoNext,callback:function(t){s.autoNext=t},expression:"autoNext"}},[s._v("答对继续下一题")])],1)]),i("div",{staticClass:"exam-content"},[i("div",{staticClass:"question-area"},[i("div",{staticClass:"question-content-scroll"},[i("div",{staticClass:"question-type"},[s._v(s._s((null===(t=s.currentQuestion)||void 0===t?void 0:t.typeName)||"单选题"))]),i("div",{staticClass:"question-title"},[i("span",{staticClass:"number"},[s._v(s._s(s.currentIndex+1)+".")]),i("span",{staticClass:"text",domProps:{innerHTML:s._s((null===(e=s.currentQuestion)||void 0===e?void 0:e.title)||"题目内容")}})]),i("div",{staticClass:"options-list"},s._l(null===(n=s.currentQuestion)||void 0===n?void 0:n.options,function(t){var e;return i("div",{key:t.id,staticClass:"option-item",class:{active:s.isOptionSelected(t.id),"multiple-choice":2===(null===(e=s.currentQuestion)||void 0===e?void 0:e.type),correct:s.isWrongMode&&s.isCorrectAnswer(t.id)},on:{click:function(e){return s.selectOption(t.id)}}},[i("span",{staticClass:"option-label"},[s._v(s._s(t.label))]),i("span",{staticClass:"option-text",domProps:{innerHTML:s._s(t.content)}})])}),0),s.isWrongMode?i("div",{staticClass:"answer-analysis"},[i("div",{staticClass:"correct-answer"},[i("span",{staticClass:"label"},[s._v("正确答案：")]),i("span",{staticClass:"value"},[s._v(s._s(s.getCorrectAnswerLabel))])]),i("div",{staticClass:"analysis"},[i("span",{staticClass:"label"},[s._v("答案解析：")]),i("div",{staticClass:"value",domProps:{innerHTML:s._s((null===(r=s.currentQuestion)||void 0===r||null===(r=r.questionsTopicVo)||void 0===r?void 0:r.analysis)||"暂无解析")}})])]):s._e(),i("div",{staticClass:"bottom-space"})])]),i("div",{staticClass:"answer-card"},[i("div",{staticClass:"card-title"},[s._v("答题卡")]),i("div",{staticClass:"card-content"},s._l(s.questions,function(t,e){return i("div",{key:e,staticClass:"question-number",class:{active:e===s.currentIndex,answered:t.answered},on:{click:function(t){return s.goToQuestion(e)}}},[s._v(" "+s._s(e+1)+" ")])}),0)])]),s.isWrongMode?i("div",{staticClass:"exam-footer"},[i("div",{staticClass:"left"},[i("el-button",{attrs:{disabled:0===s.currentIndex},on:{click:s.prevQuestion}},[s._v("上一题")]),i("el-button",{attrs:{type:"primary",disabled:s.isLastQuestion},on:{click:s.nextQuestion}},[s._v("下一题")])],1),i("div",{staticClass:"right"},[i("el-button",{on:{click:function(t){return s.$router.push("/practice")}}},[s._v("返回题库")])],1)]):i("div",{staticClass:"exam-footer"},[i("div",{staticClass:"left"},[i("el-button",{attrs:{disabled:0===s.currentIndex},on:{click:s.prevQuestion}},[s._v("上一题")]),i("el-button",{attrs:{type:"primary"},on:{click:s.handleNextOrSubmit}},[s._v(" "+s._s(s.isLastQuestion?"提交":"下一题")+" ")])],1),i("div",{staticClass:"right"},[i("el-button",{attrs:{type:"warning"},on:{click:s.submitExam}},[s._v("交卷")])],1)])])},s=[],i=n(9217),o=n(24634),u=(n(16280),n(2008),n(50113),n(48980),n(74423),n(48598),n(62062),n(26910),n(54554),n(18111),n(22489),n(20116),n(61701),n(26099),n(21699),n(47764),n(62953),n(8519)),c=n(44973),a={name:"PracticeExam",data:function(){return{currentIndex:0,questions:[],loading:!1,autoNext:!0,correctCount:0,wrongCount:0}},computed:{currentQuestion:function(){return this.questions[this.currentIndex]},totalQuestions:function(){return this.questions.length},isLastQuestion:function(){return this.currentIndex===this.totalQuestions-1},getExamTitle:function(){var t=this.$route.query.type,e={sequence:"顺序练习",random:"随机练习",wrong:"背题模式",single:"单选题练习",multiple:"多选题练习",judge:"判断题练习"};return e[t]||"练习模式"},correctRate:function(){var t=this.correctCount+this.wrongCount;return 0===t?100:Math.round(this.correctCount/t*100)},isWrongMode:function(){return"wrong"===this.$route.query.type},getCorrectAnswerLabel:function(){if(!this.currentQuestion)return"";var t=this.currentQuestion.options.filter(function(t){return 1===t.isRight});return t.map(function(t){return t.label}).join("、")}},created:function(){this.fetchQuestions()},methods:{fetchQuestions:function(){var t=this;return(0,o.A)((0,i.A)().m(function e(){var n,r,s,o,a;return(0,i.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(e.p=0,t.loading=!0,n=t.$route.query.recordId,n){e.n=1;break}throw new Error("训练组ID不存在");case 1:return e.n=2,(0,u.ro)(n);case 2:if(r=e.v,200!==r.code){e.n=4;break}if(o=(null===(s=r.data)||void 0===s?void 0:s.practiceRecordsTopicList)||[],0!==o.length){e.n=3;break}return t.$message.warning("没有可用的题目"),e.a(2);case 3:t.questions=t.formatQuestions(o),c.A.log("处理后的题目:",t.questions);case 4:e.n=6;break;case 5:e.p=5,a=e.v,c.A.error("获取试题失败:",a),t.$message.error(a.message||"获取试题失败"),t.$router.back();case 6:return e.p=6,t.loading=!1,e.f(6);case 7:return e.a(2)}},e,null,[[0,5,6,7]])}))()},formatQuestions:function(t){var e=this;return c.A.debug("格式化题目数据:",t),t.map(function(t){return{id:t.id,type:t.questionType,typeName:e.getTypeName(t.questionType),title:t.questionsTopicVo.content,options:e.formatOptions(t.questionsTopicVo.questionOptionsList),answer:null,answered:!1,isCorrect:!1,correctAnswer:t.rightOptions,questionsTopicVo:t.questionsTopicVo}})},getTypeName:function(t){var e={1:"单选题",2:"多选题",3:"判断题"};return e[t]||"未知类型"},formatOptions:function(t){return t?t.map(function(t,e){return{id:t.id||e+1,label:String.fromCharCode(65+e),content:t.content,isRight:t.isRight}}):[]},isCorrectAnswer:function(t){if(!this.currentQuestion)return!1;if(this.isWrongMode){var e=this.currentQuestion.options.find(function(e){return e.id===t});return 1===(null===e||void 0===e?void 0:e.isRight)}return Array.isArray(this.currentQuestion.correctAnswer)?this.currentQuestion.correctAnswer.includes(t):this.currentQuestion.correctAnswer===t},selectOption:function(t){var e=this;if(!this.isWrongMode&&this.currentQuestion)if(2===this.currentQuestion.type){Array.isArray(this.currentQuestion.answer)||(this.currentQuestion.answer=[]);var n=this.currentQuestion.answer.indexOf(t);-1===n?this.currentQuestion.answer.push(t):this.currentQuestion.answer.splice(n,1);var r=this.currentQuestion.answer.length>0,s=this.currentQuestion.answered,i=this.currentQuestion.isCorrect;if(this.currentQuestion.answered=r,!r&&s)return i?this.correctCount--:this.wrongCount--,void(this.currentQuestion.isCorrect=!1);if(r){var o=this.currentQuestion.answer.sort().join(","),u=Array.isArray(this.currentQuestion.correctAnswer)?this.currentQuestion.correctAnswer.sort().join(","):this.currentQuestion.correctAnswer,c=o===u;s?!i&&c?(this.wrongCount--,this.correctCount++):i&&!c&&(this.correctCount--,this.wrongCount++):c?this.correctCount++:this.wrongCount++,this.currentQuestion.isCorrect=c}}else{var a=this.currentQuestion.answered,l=this.currentQuestion.isCorrect;this.currentQuestion.answer=t,this.currentQuestion.answered=!0;var d=t===this.currentQuestion.correctAnswer;a?!l&&d?(this.wrongCount--,this.correctCount++):l&&!d&&(this.correctCount--,this.wrongCount++):d?this.correctCount++:this.wrongCount++,this.currentQuestion.isCorrect=d,d&&this.autoNext&&!this.isLastQuestion&&setTimeout(function(){e.nextQuestion()},500)}},isOptionSelected:function(t){var e;return!(null===(e=this.currentQuestion)||void 0===e||!e.answer)&&(2===this.currentQuestion.type?Array.isArray(this.currentQuestion.answer)&&this.currentQuestion.answer.includes(t):this.currentQuestion.answer===t)},prevQuestion:function(){this.currentIndex>0&&this.currentIndex--},handleNextOrSubmit:function(){this.isWrongMode?this.nextQuestion():this.isLastQuestion?this.submitExam():this.nextQuestion()},nextQuestion:function(){var t;this.isWrongMode||2===(null===(t=this.currentQuestion)||void 0===t?void 0:t.type)&&Array.isArray(this.currentQuestion.answer)&&this.currentQuestion.answer.length>0&&!this.currentQuestion.answered&&this.submitMultipleAnswer(),this.currentIndex<this.totalQuestions-1&&this.currentIndex++},goToQuestion:function(t){this.currentIndex=t},submitExam:function(){var t=this;return(0,o.A)((0,i.A)().m(function e(){var n;return(0,i.A)().w(function(e){while(1)switch(e.n){case 0:n=t.questions.findIndex(function(t){return 2===t.type?!t.answered||!Array.isArray(t.answer)||0===t.answer.length:!t.answer}),-1!==n?t.$confirm("第 ".concat(n+1," 题还未作答，是否继续提交？"),"提示",{confirmButtonText:"继续提交",cancelButtonText:"返回作答",type:"warning"}).then(function(){t.submitAllAnswers()}).catch(function(){t.goToQuestion(n)}):t.submitAllAnswers();case 1:return e.a(2)}},e)}))()},submitAllAnswers:function(){var t=this;return(0,o.A)((0,i.A)().m(function e(){var n,r;return(0,i.A)().w(function(e){while(1)switch(e.p=e.n){case 0:return e.p=0,t.loading=!0,n=t.questions.map(function(t){if(!t.answer||Array.isArray(t.answer)&&0===t.answer.length)return null;var e=Array.isArray(t.answer)?t.answer.join(","):t.answer;return(0,u.Wv)({id:t.id,userOptions:e})}).filter(Boolean),e.n=1,Promise.all(n);case 1:t.$message.success("提交成功"),t.$router.push("/practice"),e.n=3;break;case 2:e.p=2,r=e.v,c.A.error("提交答案失败:",r),t.$message.error("提交答案失败");case 3:return e.p=3,t.loading=!1,e.f(3);case 4:return e.a(2)}},e,null,[[0,2,3,4]])}))()},submitMultipleAnswer:function(){var t=this;if(this.currentQuestion&&Array.isArray(this.currentQuestion.answer)){this.currentQuestion.answered=!0;var e=this.currentQuestion.answer.sort().join(","),n=this.currentQuestion.correctAnswer.split(",").sort().join(","),r=e===n;r?(this.correctCount++,this.autoNext&&!this.isLastQuestion&&setTimeout(function(){t.nextQuestion()},500)):this.wrongCount++}}}},l=a,d=n(81656),h=(0,d.A)(l,r,s,!1,null,"476ae08e",null),p=h.exports},8519:function(t,e,n){n.d(e,{Dv:function(){return o},Gr:function(){return h},N5:function(){return u},Wv:function(){return d},dd:function(){return s},pt:function(){return c},ro:function(){return l},sI:function(){return i},tj:function(){return a},zq:function(){return p}});var r=n(47120);function s(t){return(0,r.A)({url:"/system/repos/list",method:"get",params:t})}function i(t){return(0,r.A)({url:"/reposCollections/reposCollections/myRepos",method:"get",params:t})}function o(t){return(0,r.A)({url:"/reposCollections/reposCollections/collect/".concat(t),method:"get"})}function u(t){return(0,r.A)({url:"/reposCollections/reposCollections/cancelCollect/".concat(t),method:"get"})}function c(t){return(0,r.A)({url:"/practice/repo/info/".concat(t),method:"get"})}function a(t){return(0,r.A)({url:"/practice/practiceRecords/start",method:"post",data:t})}function l(t){return(0,r.A)({url:"/practice/practiceRecords/".concat(t),method:"get"})}function d(t){return(0,r.A)({url:"/practice/recordsTopic/puOption",method:"post",data:t})}function h(t){return(0,r.A)({url:"/system/repos/getTopicType/".concat(t),method:"get"})}function p(t){return(0,r.A)({url:"/practice/practiceRecords/list",method:"get",params:t})}}}]);
//# sourceMappingURL=829-legacy.2a933663.js.map