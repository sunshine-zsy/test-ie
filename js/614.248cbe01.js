"use strict";(self["webpackChunkpc_exam_student"]=self["webpackChunkpc_exam_student"]||[]).push([[614],{33443:function(e,t,a){a.d(t,{PY:function(){return c},V1:function(){return r},bC:function(){return o},il:function(){return s},mj:function(){return i}});var n=a(47120);function r(e){return(0,n.A)({url:"/system/dict/data/list",method:"get",params:e})}function i(e){return(0,n.A)({url:"/system/oss/listByIds/".concat(e),method:"get"})}function s(){return(0,n.A)({url:"/system/dict/data/type/course_categories",method:"get"})}function o(){return(0,n.A)({url:"/system/dict/data/type/question_repos_type",method:"get"})}function c(e){return(0,n.A)({url:"/system/dict/data/list",method:"get",params:e})}},38429:function(e,t,a){a.d(t,{PZ:function(){return c},QC:function(){return s},S0:function(){return o},Xs:function(){return u},b1:function(){return i},bH:function(){return m},gD:function(){return r},nQ:function(){return l}});var n=a(47120);function r(e){return(0,n.A)({url:"/exam/questionExam/list",method:"get",params:e})}function i(e){return(0,n.A)({url:"/exam/detail/".concat(e),method:"get"})}function s(e){return(0,n.A)({url:"/exam/paper/".concat(e),method:"get"})}function o(e){return(0,n.A)({url:"/exam/examScore/startExam",method:"post",data:e})}function c(e){return(0,n.A)({url:"/exam/examSubmission/submit",method:"post",data:e})}function u(e){return(0,n.A)({url:"/exam/examScore/".concat(e),method:"get"})}function l(e){return(0,n.A)({url:"/exam/computer/endComputerInfo",method:"post",data:e})}function m(e){return(0,n.A)({url:"/exam/computer",method:"post",data:e})}},91614:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var n={};a.r(n);var r=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"exam-container"},[e.examList.length>0?t("div",{staticClass:"exam-list"},e._l(e.examList,function(a){return t("div",{key:a.id,staticClass:"exam-item"},[t("div",{staticClass:"exam-title"},[e._v(e._s(a.name))]),t("div",{staticClass:"exam-info"},["hall"===e.activeTab?[t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("考试时间：")]),t("span",{staticClass:"value"},[e._v(e._s(a.startTime)+" ~ "+e._s(a.endTime))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("考试机会：")]),t("span",{staticClass:"value"},[e._v(e._s(a.chances))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("考试状态：")]),t("el-tag",{attrs:{size:"small",type:a.statusType}},[e._v(e._s(a.status))])],1)]:[t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("考试得分：")]),t("span",{staticClass:"value"},[e._v(e._s(a.score)+"分")])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("考试时间：")]),t("span",{staticClass:"value"},[e._v(e._s(a.examTime))])]),t("div",{staticClass:"info-row"},[t("span",{staticClass:"label"},[e._v("是否及格：")]),t("el-tag",{attrs:{size:"small",type:a.score>=a.passScore?"success":"danger"}},[e._v(" "+e._s(a.score>=a.passScore?"及格":"不及格")+" ")])],1)]],2),t("div",{staticClass:"exam-footer"},[t("div",{staticClass:"score-info"},[t("span",{staticClass:"time"},[e._v("时长："+e._s(a.duration)+"分钟")]),t("span",{staticClass:"total"},[e._v("总分："+e._s(a.totalScore)+"分")]),t("span",{staticClass:"pass"},[e._v("及格分："+e._s(a.passScore)+"分")])]),t("div",{staticClass:"actions"},["hall"===e.activeTab?[t("el-tag",{attrs:{type:"success",size:"small"}},[e._v(e._s(a.openTypeLabel))]),t("el-button",{attrs:{type:"primary",size:"small",disabled:"进行中"!==a.status},on:{click:function(t){return e.startExam(a)}}},[e._v("进入考试")])]:[t("el-button",{attrs:{type:"primary",size:"small"},on:{click:function(t){return e.viewExamDetail(a)}}},[e._v("查看详情")])]],2)])])}),0):t("el-empty",{attrs:{description:"暂无考试信息"}}),t("div",{staticClass:"pagination-container"},[t("el-pagination",{attrs:{"current-page":e.pageNum,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.total,layout:"total, sizes, prev, pager, next, jumper",background:""},on:{"update:currentPage":function(t){e.pageNum=t},"update:current-page":function(t){e.pageNum=t},"update:pageSize":function(t){e.pageSize=t},"update:page-size":function(t){e.pageSize=t},"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},i=[],s=a(9217),o=a(24634),c=(a(44114),a(18111),a(61701),a(18237),a(38429)),u=a(33443),l=a(22856),m=a(1594),p=a(95711),d=a(44973);l["default"].use(m.Ay);var h=[{path:"/login",name:"Login",component:function(){return Promise.all([a.e(917),a.e(989)]).then(a.bind(a,96989))},meta:{title:"登录"}},{path:"/",component:p.A,redirect:"/course",children:[{path:"course",name:"Course",component:function(){return Promise.all([a.e(595),a.e(383)]).then(a.bind(a,64595))},meta:{title:"课程列表",requireAuth:!0}},{path:"exam",name:"Exam",component:function(){return Promise.resolve().then(a.bind(a,91614))},meta:{title:"考试中心",requireAuth:!0}},{path:"my",name:"My",component:function(){return a.e(491).then(a.bind(a,22491))},meta:{title:"个人中心",requireAuth:!0}},{path:"course/detail/:id",name:"CourseDetail",component:function(){return Promise.all([a.e(868),a.e(197)]).then(a.bind(a,70868))},meta:{title:"课程详情",requireAuth:!0}}]},{path:"/practice",component:p.A,children:[{path:"",name:"Practice",component:function(){return Promise.all([a.e(405),a.e(300)]).then(a.bind(a,26405))},meta:{title:"刷题训练",requireAuth:!0}},{path:"exam/:id",name:"PracticeExam",component:function(){return a.e(829).then(a.bind(a,4829))},meta:{title:"练习模式",requireAuth:!0}}]},{path:"/practice/detail/:id",name:"PracticeDetail",component:function(){return a.e(717).then(a.bind(a,29717))},meta:{title:"题库详情"}},{path:"/exam",component:p.A,children:[{path:"",name:"Exam",component:function(){return Promise.resolve().then(a.bind(a,91614))},meta:{title:"考试中心",requireAuth:!0}},{path:"check/:id",name:"ExamCheck",component:function(){return a.e(92).then(a.bind(a,28711))},meta:{title:"考试审核",requireAuth:!0}},{path:"paper/:id",name:"ExamPaper",component:function(){return Promise.all([a.e(251),a.e(482)]).then(a.bind(a,48251))},meta:{title:"考试详情",requireAuth:!0}},{path:"detail/:id",name:"ExamDetail",component:function(){return a.e(481).then(a.bind(a,83862))},meta:{title:"考试详情",requireAuth:!0}},{path:"thanks",name:"ExamThanks",component:function(){return a.e(359).then(a.bind(a,90359))},meta:{title:"考试完成",requireAuth:!0}}]}],f=new m.Ay({routes:h,scrollBehavior:function(){return{y:0}}}),g=["/login"];f.beforeEach(function(){var e=(0,o.A)((0,s.A)().m(function e(t,a,n){var r,i,o,c;return(0,s.A)().w(function(e){while(1)switch(e.p=e.n){case 0:if(r=localStorage.getItem("token"),d.A.debug("路由跳转:",{from:a.fullPath,to:t.fullPath,hasToken:!!r}),e.p=1,"/login"!==t.path){e.n=2;break}return r?n("/"):n(),e.a(2);case 2:r||g.includes(t.path)?n():(o=(null===(i=t.query)||void 0===i?void 0:i.redirect)||t.fullPath,n({path:"/login",query:{redirect:o}})),e.n=4;break;case 3:e.p=3,c=e.v,d.A.error("路由守卫错误:",c),n("/login");case 4:return e.a(2)}},e,null,[[1,3]])}));return function(t,a,n){return e.apply(this,arguments)}}());var v={name:"ExamCenter",data:function(){return{activeTab:"hall",searchKey:"",dateRange:[],examList:[],loading:!1,pageNum:1,pageSize:10,total:0,examStateDict:{0:{label:"未开始",type:"info"},1:{label:"进行中",type:"success"},2:{label:"已结束",type:"danger"}},openTypeDict:{},searchTimer:null}},created:function(){this.getOpenTypeDict(),this.fetchExamList()},methods:{getOpenTypeDict:function(){var e=this;return(0,o.A)((0,s.A)().m(function t(){var a,n;return(0,s.A)().w(function(t){while(1)switch(t.p=t.n){case 0:return t.p=0,t.n=1,(0,u.V1)({pageNum:1,pageSize:10,dictType:"exam_open_type"});case 1:a=t.v,200===a.code&&(e.openTypeDict=(a.rows||[]).reduce(function(e,t){return e[t.dictValue]={label:t.dictLabel,isFree:"1"===t.dictValue},e},{})),t.n=3;break;case 2:t.p=2,n=t.v,console.error("获取开放类型字典失败:",n);case 3:return t.a(2)}},t,null,[[0,2]])}))()},fetchExamList:function(){var e=this;return(0,o.A)((0,s.A)().m(function t(){var a,r,i,o;return(0,s.A)().w(function(t){while(1)switch(t.p=t.n){case 0:if(t.p=0,e.loading=!0,a={pageNum:e.pageNum,pageSize:e.pageSize,title:e.searchKey},"hall"!==e.activeTab){t.n=2;break}return e.dateRange&&2===e.dateRange.length&&(a.startTime=e.formatDateTime(e.dateRange[0]),a.endTime=e.formatDateTime(e.dateRange[1])),t.n=1,(0,c.gD)(a);case 1:r=t.v,200===r.code&&(e.examList=(r.rows||[]).map(function(t){var a,n,r,i,s=e.openTypeDict[t.openType]||{};return{id:t.id,paperId:null===(a=t.questionPaperVo)||void 0===a?void 0:a.id,name:t.title||"未命名考试",startTime:t.startTime,endTime:t.endTime,chances:-1===t.chance?"不限":"".concat(t.chance,"次"),status:(null===(n=e.examStateDict[t.examState])||void 0===n?void 0:n.label)||"未知",statusType:(null===(r=e.examStateDict[t.examState])||void 0===r?void 0:r.type)||"info",duration:t.totalTime,totalScore:(null===(i=t.questionPaperVo)||void 0===i?void 0:i.totalScore)||0,passScore:t.qualifyScore||0,isFree:s.isFree,openTypeLabel:s.label||"未知",content:t.content||""}}),e.total=r.total),t.n=4;break;case 2:return t.n=3,(0,n["default"])({url:"/exam/examScore/myScoreList",method:"get",params:a});case 3:i=t.v,200===i.code&&(e.examList=(i.rows||[]).map(function(e){return{id:e.id,examId:e.examId,name:e.examName,score:e.currentScore||0,examTime:e.submitTime,duration:e.finishTime||0,totalScore:e.totalScore||0,passScore:e.qualifyScore||0,isPass:1===e.isPass}}),e.total=i.total);case 4:t.n=6;break;case 5:t.p=5,o=t.v,console.error("获取考试列表失败:",o),e.$message.error("获取考试列表失败");case 6:return t.p=6,e.loading=!1,t.f(6);case 7:return t.a(2)}},t,null,[[0,5,6,7]])}))()},startExam:function(e){var t=JSON.parse(localStorage.getItem("userInfo")||"{}");if(console.log("userInfo",JSON.parse(localStorage.getItem("userInfo"))),!t.userId)return this.$message.error("用户信息获取失败，请重新登录"),void this.$router.push("/login");this.$router.push({name:"ExamPaper",params:{id:e.paperId},query:{examId:e.id,studentId:t.userId,title:e.name,duration:e.duration,totalScore:e.totalScore,passScore:e.passScore}})},handleInput:function(){var e=this;this.searchTimer&&clearTimeout(this.searchTimer),this.searchTimer=setTimeout(function(){e.handleSearch()},300)},handleSearch:function(){this.searchTimer&&clearTimeout(this.searchTimer),this.pageNum=1,this.fetchExamList()},resetSearch:function(){this.searchKey="",this.dateRange=[],this.handleSearch()},handleSizeChange:function(e){this.pageSize=e,this.pageNum=1,this.fetchExamList()},handleCurrentChange:function(e){this.pageNum=e,this.fetchExamList()},formatDateTime:function(e){if(!e)return"";var t=new Date(e),a=t.getFullYear(),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),i=String(t.getHours()).padStart(2,"0"),s=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");return"".concat(a,"-").concat(n,"-").concat(r," ").concat(i,":").concat(s,":").concat(o)},handleTabClick:function(){var e=this;return(0,o.A)((0,s.A)().m(function t(){return(0,s.A)().w(function(t){while(1)switch(t.n){case 0:return e.pageNum=1,e.searchKey="",e.dateRange=[],t.n=1,e.fetchExamList();case 1:return t.a(2)}},t)}))()},viewExamDetail:function(e){this.$router.push({path:"/exam/detail/".concat(e.id),query:{examId:e.examId,name:e.name,score:e.score,totalScore:e.totalScore,passScore:e.passScore,examTime:e.examTime}})}},beforeDestroy:function(){this.searchTimer&&clearTimeout(this.searchTimer)}},x=v,S=a(81656),b=(0,S.A)(x,r,i,!1,null,"1c795a50",null),y=b.exports}}]);
//# sourceMappingURL=614.248cbe01.js.map